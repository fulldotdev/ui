---
import type { ComponentProps } from 'astro/types'
import type { CollectionEntry } from 'astro:content'
import Footer from 'fulldev-ui/blocks/Footer.astro'
import Header from 'fulldev-ui/blocks/Header.astro'
import Container from 'fulldev-ui/components/Container.astro'
import Element from 'fulldev-ui/components/Element.astro'
import Heading from 'fulldev-ui/components/Heading.astro'
import Layout from 'fulldev-ui/components/Layout.astro'
import Paragraph from 'fulldev-ui/components/Paragraph.astro'
import Prose from 'fulldev-ui/components/Prose.astro'
import Sidebar from 'fulldev-ui/components/Sidebar.astro'
import Toc from 'fulldev-ui/components/Toc.astro'
import type { PageSchema } from 'fulldev-ui/schemas/page.ts'

interface Props extends ComponentProps<typeof Layout>, PageSchema {
  render: CollectionEntry<'pages'>['render']
}

const { header, sidebar, render, title, description, footer } = Astro.props

const { Content, headings } = await render()
---

<Layout
  class:list="doc"
  {...Astro.props}
>
  <Header
    {...sidebar}
    {...header}
  />
  <Container class:list="doc-container">
    <Sidebar {...sidebar} />
    <Element
      class:list="doc-main"
      as="main"
    >
      <Prose>
        <Heading
          as="h1"
          size="4xl"
          text={title}
        />
        <Paragraph
          muted
          size="lg"
          text={description}
        />
        <Content />
      </Prose>
      <Toc
        {title}
        {headings}
      />
    </Element>
  </Container>
  <Footer {...footer} />
</Layout>

<style is:global>
  @layer fulldev {
    .doc {
      .doc-container {
        @apply flex gap-x-gutter;
      }

      .doc-main {
        @apply flex grow items-start justify-evenly gap-x-gutter py-8;
      }

      .toc {
        @apply lg:top-sticky-8;
      }
    }
  }
</style>
