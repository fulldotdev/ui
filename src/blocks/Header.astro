---
import Box from '@/components/Box.astro'
import Buttons from '@/components/Buttons.astro'
import Container from '@/components/Container.astro'
import Drawer from '@/components/Drawer.astro'
import Icon from '@/components/Icon.astro'
import Link from '@/components/Link.astro'
import Logo from '@/components/Logo.astro'
import Menu from '@/components/Menu.astro'
import NavigationMenu from '@/components/NavigationMenu.astro'
import Search from '@/components/Search.astro'
import { cn } from '@/lib/utils'
import type { HeaderSchema } from '@/schemas/blocks/header'

interface Props extends HeaderSchema {
  search?: any
}

const { logo, menus, buttons, search, class: className } = Astro.props
---

<Box
  class={cn('header bg-background sticky top-0 z-20 flex h-14 w-full border-b', className)}
  as="header"
>
  <Container class="flex items-center justify-between gap-8">
    <Box class="flex items-center gap-4">
      <Logo {...logo} />
      <NavigationMenu
        class="max-lg:hidden"
        items={menus}
      />
    </Box>
    <Box class="inline-flex items-center gap-2">
      <!-- <Search groups={search} /> -->
      <Buttons
        class="max-sm:hidden"
        size="sm"
        {buttons}
        reverse
      />

      <!-- fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background max-h-[60svh] p-0 -->
      <!-- max-h-[60svh] -->
      <Drawer
        class="size-8 lg:hidden"
        size="icon"
        variant="ghost"
      >
        <Icon
          slot="trigger"
          name="menu-2"
          class="!text-xl"
        />
        <Box class="overflow-auto">
          <Container class="flex min-w-lg flex-col gap-2">
            {
              menus?.map(({ text, href, links }) =>
                links ? (
                  <Menu
                    class="my-4"
                    {text}
                    {links}
                  />
                ) : (
                  <Link
                    class="text-foreground"
                    {href}
                    {text}
                  />
                )
              )
            }
            <Buttons
              class="mt-4 flex-col gap-2"
              reverse
              {buttons}
            />
          </Container>
        </Box>
      </Drawer>
    </Box>
  </Container>
</Box>
