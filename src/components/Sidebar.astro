---
import type { ComponentProps, HTMLAttributes } from 'astro/types'
import Element from 'fulldev-ui/components/Element.astro'
import Logo from 'fulldev-ui/components/experimental/Logo.astro'
import Menu from 'fulldev-ui/components/Menu.astro'
import ThemeSelect from 'fulldev-ui/components/ThemeSelect.astro'
import type { GlobalProps } from 'fulldev-ui/types/global-props'
import Heading from './Heading.astro'
import Toc from './Toc.astro'

interface Props extends GlobalProps, HTMLAttributes<'aside'> {
  menu?: ComponentProps<typeof Menu>['groups']
  heading?: ComponentProps<typeof Heading>['text']
  render?: ComponentProps<typeof Toc>['render']
  logo?: ComponentProps<typeof Logo>
  toc?: ComponentProps<typeof Toc>['heading']
  company?: ComponentProps<typeof Logo>['company']
  themeselect?: boolean | undefined
}

const {
  size = 'sm',
  logo,
  company,
  render,
  themeselect,
  menu,
  toc,
  heading,
  ...rest
} = Astro.props

console.log(Astro.props)
---

<Element
  class:list="sidebar"
  as="aside"
  {size}
  {...rest}
>
  <Element
    class:list="sidebar-header"
    as="header"
  >
    <Logo
      {company}
      {...logo}
    />
    <Heading
      level={4}
      text={heading}
    />
    <slot name="header" />
  </Element>
  <Element class:list="sidebar-content">
    <Toc
      {render}
      heading={toc}
    />
    <Menu groups={menu} />
    <ThemeSelect if={themeselect} />
    <slot />
  </Element>
</Element>

<style lang="scss" is:global>
  @layer fulldev {
    .sidebar {
      display: none;

      @media (min-width: 1024px) {
        display: flex;
        position: sticky;
        top: var(--header-height, 0px);
        flex-shrink: 0;
        flex-direction: column;
        justify-content: flex-start;
        z-index: 10;
        border-right: 1px solid var(--color-a6);
        width: calc(var(--space-7) * 4);
        height: calc(100vh - var(--header-height, 0px));

        .sidebar-header {
          display: flex;
          position: sticky;
          align-items: center;
          border-bottom: 1px solid var(--color-a6);
          padding: 0 var(--gutter);
          width: 100%;
          height: 56px;
        }

        .sidebar-content {
          display: flex;
          top: 0;
          flex: 1;
          flex-direction: column;
          padding: var(--space-6) var(--gutter);
          width: 100%;
          overflow-y: auto;
        }
      }
    }
  }
</style>
