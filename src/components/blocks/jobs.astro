---
import { getCollection, getEntries } from "astro:content"

import { type JobsSchema } from "@/schemas/blocks/jobs"
import { getHref } from "@/lib/get-href"
import Jobs1 from "@/components/blocks/jobs-1"

type Props = JobsSchema

const { variant, jobs, html, ...schema } = Astro.props

const jobEntries = jobs
  ? await getEntries(jobs)
  : await getCollection("pages", (page) => page.data.type === "job")

const props = {
  ...schema,
  jobs: await Promise.all(
    jobEntries.map(async (job) => ({
      href: getHref(job),
      ...job.data,
    }))
  ),
}
---

{
  variant === "1" && (
    <Jobs1 {...props}>
      <Fragment set:html={html} />
      <slot />
    </Jobs1>
  )
}
