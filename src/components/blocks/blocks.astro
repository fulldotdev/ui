---
import { getCollection, getEntries } from "astro:content"

import { type BlocksSchema } from "@/schemas/blocks/blocks"
import { getHref } from "@/lib/get-href"
import { transformImage } from "@/lib/transform-image"
import Blocks1 from "@/components/blocks/blocks-1"

type Props = BlocksSchema

const { variant, blocks, html, ...schema } = Astro.props

const blockEntries = blocks
  ? await getEntries(blocks)
  : await getCollection("blocks")

const props = {
  ...schema,
  blocks: await Promise.all(
    blockEntries.map(async (block) => ({
      href: getHref(block),
      title: block.id,
    }))
  ),
}
---

{
  variant === "1" && (
    <Blocks1 {...props}>
      <Fragment set:html={html} />
      <slot />
    </Blocks1>
  )
}
