---
import { getEntries } from 'astro:content'

interface Props {
  component?: string
  [key: string]: any
}

let { component, products, categories, ...rest } = Astro.props

products = products && (await getEntries(products))
categories = categories && (await getEntries(categories))

const allComponents = {
  ...import.meta.glob('/src/**/*.astro'),
  ...import.meta.glob('../../**/*.astro'),
}

const componentPath = Object.keys(allComponents).find(
  (path) => path.split('/').pop()?.split('.')[0] === component
)

const Component =
  componentPath && (await (allComponents[componentPath] as any)()).default
---

<Component
  {products}
  {categories}
  {...rest}
/>
