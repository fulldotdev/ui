---
import type { ComponentProps, HTMLAttributes } from 'astro/types'
import Button from 'fulldev-ui/components/Button.astro'
import Channels from 'fulldev-ui/components/Channels.astro'
import Element from 'fulldev-ui/components/Element.astro'
import Heading from 'fulldev-ui/components/Heading.astro'
import Social from 'fulldev-ui/components/Social.astro'
import Socials from 'fulldev-ui/components/Socials.astro'
import Text from 'fulldev-ui/components/Text.astro'
import Logo from 'fulldev-ui/components/experimental/Logo.astro'

interface Props
  extends ComponentProps<typeof Element>,
    HTMLAttributes<'footer'> {
  screen?: number | undefined
  logo?: string | undefined
  text?: string | undefined
  hours?: any
  socials?: (string | ComponentProps<typeof Social>)[] | undefined
  buttons?: ComponentProps<typeof Button>[] | undefined
  panel?: boolean | undefined
  channels?: any
  columns?: {
    heading: string | undefined
    buttons: ComponentProps<typeof Button>[] | undefined
  }[]
}

const {
  as = 'footer',
  space = 'auto',
  size = 'sm',
  screen = 1280,
  hours,
  panel,
  logo,
  socials,
  heading,
  buttons,
  columns,
  text,
  title,
  description,
  channels,
  ...rest
} = Astro.props
---

<Element
  class:list="footer"
  style={{ '--screen': `${screen}px` }}
  structure="stack"
  {as}
  {panel}
  {space}
  {size}
  {...rest}
>
  <Element class:list="column">
    <Logo {logo} />
    <Text
      color="base"
      {text}
    />
    <Socials {socials} />
  </Element>

  <Channels {channels} />

  <Element class:list="hours column">
    <Heading
      text={hours?.heading}
      level={5}
    />
    <Element>
      {
        Object.entries(hours?.days ?? {})?.map(([key, value]: any) => (
          <Element class:list="spread">
            <Text text={key} />
            <Text text={value} />
          </Element>
        ))
      }
    </Element>
  </Element>

  <Element class:list="buttons column">
    {
      columns?.map(({ heading, buttons }: any) => (
        <Element>
          <Heading
            level={5}
            text={heading}
          />
          {buttons?.map((button: any) => (
            <Button
              variant="link"
              {...button}
            />
          ))}
        </Element>
      ))
    }
  </Element>
</Element>

<style is:global lang="scss">
  @layer fulldev {
    .footer {
      display: grid;
      position: relative;
      grid-template-columns: 1fr;
      align-items: flex-start;
      gap: var(--space-6);
      margin-top: auto;
      border-top-width: 1px;
      border-color: var(--base-a6);
      background-color: var(--base-2);
      padding: var(--space-7) var(--gutter);
      width: 100%;
      overflow: auto;

      @media (min-width: 1024px) {
        grid-auto-columns: 1fr;
        grid-auto-flow: column;
      }

      .spread {
        display: flex;
        justify-content: space-between;
      }

      .column {
        display: flex;
        flex-direction: column;
      }

      .socials {
        display: flex;
      }

      .column {
        h5 + * {
          margin-top: var(--space-4);
        }

        .button.variant-link + .button.variant-link {
          margin-top: var(--space-4);
        }
      }

      &.panel {
        margin: var(--spacer) var(--gutter);
        border-width: 1px;
        border-radius: var(--radius-2);
        overflow: hidden;
      }

      .channels {
        gap: var(--space-3);
      }

      .buttons {
        display: grid;
        position: relative;
        grid-template-columns: 1fr;
        align-items: flex-start;
        gap: var(--space-3);
        gap: var(--space-6);
        width: 100%;

        @media (min-width: 1024px) {
          grid-auto-columns: 1fr;
          grid-auto-flow: column;
        }
      }

      .text {
        max-width: calc(5 * var(--space-7));
      }

      .hours {
        .column {
          gap: 0;

          .text {
            font-size: var(--text-2);
          }
        }
      }
    }
  }
</style>
