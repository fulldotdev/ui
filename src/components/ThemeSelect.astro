---
import Select from 'fulldev-ui/components/Select.astro'
// const defaultTheme = fulldevConfig.colors.theme || 'light'

const { ...rest } = Astro.props
---

<Select
  class:list="theme-select"
  name="theme-select"
  options={['light', 'dark']}
  value="light"
  onchange="localStorage.setItem('theme', this.value); window.location.reload();"
  {...rest}
/>

<script>
  const setOption = (document: Document) => {
    const selects = document.querySelectorAll('.theme-select')
    const theme = localStorage.getItem('theme') || ''
    selects?.forEach((select) => {
      const options = select?.querySelectorAll('option')
      options?.forEach((option) => {
        if (option.value === theme) option.selected = true
        else option.selected = false
      })
    })
  }

  setOption(document)

  document.addEventListener('astro:before-swap', (event) => {
    setOption(event.newDocument)
  })
</script>

<style is:global >
  .theme-select {
    width: calc(1.4 * var(--space-7));
  }
</style>
