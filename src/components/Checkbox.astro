---
import type { ComponentProps, HTMLAttributes } from 'astro/types'
import Element from 'fulldev-ui/components/Element.astro'
import Label from 'fulldev-ui/components/Label.astro'
import type { GlobalProps } from 'fulldev-ui/types/global-props'
import Icon from './Icon.astro'

interface Props extends GlobalProps, HTMLAttributes<'input'> {
  label?: ComponentProps<typeof Label>['text']
}

const {
  label,
  name = label,
  id = name,
  type = 'text',
  size = 'md',
  ...rest
} = Astro.props
---

<Element
  class:list="checkbox"
  as="label"
  for={id}
  {size}
>
  <Element
    class:list="checkbox-input"
    as="input"
    type="checkbox"
    if={id}
    {id}
    {name}
    {...rest}
  />
  <Icon
    class="checkbox-icon"
    name="check"
  />
  <Label
    for={id}
    text={label}
    {size}
  />
</Element>

<style is:global>
  @layer fulldev {
    .checkbox {
      @apply relative flex items-center gap-2;

      .checkbox-input {
        @apply size-[1em] cursor-pointer rounded-sm border border-primary bg-transparent accent-primary;
        @apply appearance-none border border-primary bg-background checked:bg-primary;
      }

      .icon.checkbox-icon {
        @apply absolute bg-transparent p-0.5 text-background;

        * {
          stroke-width: 3.5px !important;
        }
      }

      &.size-sm {
        .checkbox-input,
        .icon.checkbox-icon {
          @apply !size-3.5;
        }
      }
      &.size-md {
        .checkbox-input,
        .checkbox-icon {
          @apply !size-4;
        }
      }

      &.size-lg {
        .checkbox-input,
        .checkbox-icon {
          @apply !size-[1.125rem];
        }
      }
    }
  }
</style>
