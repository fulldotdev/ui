---
import { marked } from 'marked'

let { type, variant, content, ...rest } = Astro.props

const blocks = import.meta.glob('../blocks/**/*.astro')

const blockName = `${type}${variant || 1}`
const path = Object.keys(blocks).find((path) => path.split('/').pop()?.split('.')[0] === blockName)

const BlockComponent = path && (await (blocks[path] as any)()).default

const markdownHtml = marked(content || '')
---

{
  BlockComponent && (
    <BlockComponent {...rest}>
      <Fragment set:html={markdownHtml} />
    </BlockComponent>
  )
}
