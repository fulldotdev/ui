---
import type { ComponentProps, HTMLAttributes } from 'astro/types'
import Buttons from 'fulldev-ui/components/Buttons.astro'
import Element from 'fulldev-ui/components/Element.astro'
import Logo from 'fulldev-ui/components/Logo.astro'
// import ThemeSelect from 'fulldev-ui/components/ThemeSelect.astro'
import type { GlobalProps } from 'fulldev-ui/types/global-props'
import Cart from './Cart.astro'
import Drawer from './Drawer.astro'
import Links from './Links.astro'
import type Menu from './Menu.astro'
import Socials from './Socials.astro'

interface Props extends GlobalProps, HTMLAttributes<'header'> {
  logo?: ComponentProps<typeof Logo>
  company?: ComponentProps<typeof Logo>['company']
  buttons?: ComponentProps<typeof Buttons>['buttons']
  links?: ComponentProps<typeof Links>['links']
  menu?: ComponentProps<typeof Menu>['groups']
  panel?: boolean | undefined
  search?: boolean | undefined
  open?: boolean | undefined
  themeselect?: boolean | undefined
  cart?: string | undefined
  socials?: ComponentProps<typeof Socials>['socials']
}

const {
  size = 'sm',
  open,
  logo,
  company,
  buttons,
  links,
  search,
  panel,
  socials,
  menu,
  themeselect,
  cart,
  ...rest
} = Astro.props
---

<Element
  class:list={['header']}
  as="header"
  {panel}
  {size}
  {open}
  {...rest}
>
  <Logo
    {company}
    {...typeof logo === 'string' ? { src: logo } : logo}
  />
  <Links {links} />
  <Socials
    variant="ghost"
    {socials}
  />
  <Buttons
    {buttons}
    variant="link"
  >
    <!-- {themeselect && <ThemeSelect />} -->

    <Cart
      if={cart}
      variant="secondary"
      heading={cart}
    />
    <Drawer
      class:list={['header-button']}
      icon="menu-2"
      id="menu"
      variant="secondary"
      {logo}
      {company}
      {buttons}
      {menu}
    />
  </Buttons>
</Element>

<style is:global>
  @layer fulldev {
    .header {
      @apply px-gutter sticky left-0 top-0 z-20 flex h-14 items-center gap-2 overflow-hidden border-b bg-background py-2;

      &,
      & ~ * {
        --header-height: 3.5rem;
      }

      &.panel {
        @apply mx-gutter top-2 my-2 rounded-lg border px-4;
      }

      .logo {
        @apply justify-self-start;
      }

      .links {
        @apply mx-auto ml-4 max-lg:hidden;
      }

      .socials {
        @apply ml-auto max-lg:hidden;
      }

      .buttons {
        @apply justify-self-end max-lg:ml-auto;
      }

      .menu-button {
        @apply lg:hidden;
      }

      @media (min-width: 1024px) {
        &:not(.open) {
          display: none;

          & ~ * {
            --header-height: 0px;
          }
        }
      }
    }
  }
</style>
