---
import type { ComponentProps } from 'astro/types'
import Button from 'fulldev-ui/components/Button.astro'
import Card from 'fulldev-ui/components/Card.astro'
import type Icon from './Icon.astro'
import type Label from './Label.astro'

interface Props extends ComponentProps<typeof Card> {
  icon?: ComponentProps<typeof Icon>['name']
  label?: ComponentProps<typeof Label>['text']
}

const {
  variant = 'secondary',
  label,
  icon,
  id = 'dialog',
  ...rest
} = Astro.props
---

<Button
  size="sm"
  id={`${id}-button`}
  variant="secondary"
  onclick={`document.getElementById('${id}').showModal()`}
  {icon}
/>

<dialog
  class="dialog"
  id={id as string}
  onclick={`event.target === this && this.close()`}
>
  <Card
    panel
    {...rest}
  >
    <slot />
  </Card>
</dialog>

<style is:global>
  @layer fulldev {
    .dialog {
      margin: auto !important;
      outline: 0;
      border: 0;
      background: none;
      padding: var(--space-7) var(--gutter);
      max-width: 768px;
      max-height: 80vh;
      overflow: hidden;

      &::backdrop {
        background: rgba(0, 0, 0, 0.5);
      }

      .card {
        width: 100%;
        height: 100%;
        max-height: 80vh !important;
        overflow: auto !important;
      }
    }
  }
</style>
