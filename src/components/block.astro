---
import type { BlockSchema } from "@/lib/schemas"
import { getGlob, getImage, getImages, getPages } from "@/lib/transforms"
import { Block as ReactBlock } from "@/components/block"

type Props = BlockSchema

const { image, images, glob, pages, items, ...rest } = Astro.props

const transformedImage = image ? await getImage(image) : undefined
const transformedImages = images ? await getImages(images) : undefined

const transformedGlob = glob ? await getGlob(glob) : []
const transformedPages = pages ? await getPages(pages) : []
const transformedItems = items || []
---

<ReactBlock
  client:load
  image={transformedImage}
  images={transformedImages}
  items={[...transformedItems, ...transformedGlob, ...transformedPages]}
  {...rest}
/>
