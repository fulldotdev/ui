---
import type { HTMLTag, Polymorphic } from 'astro/types'
import type { CollectionEntry } from 'astro:content'
import { getEntry } from 'astro:content'
import Root from 'fulldev-ui/components/Root.astro'

type Props<As extends HTMLTag = 'a'> = Polymorphic<{ as: As }> & {
  size?: 'sm' | 'md' | 'lg' | undefined
  color?: 'base' | 'brand' | undefined
  contrast?: boolean | undefined
  html?: string | undefined
  text?: string | undefined
  slug?: CollectionEntry<'pages'>['slug'] | undefined
}

const { slug, href, html, text, as = 'a', ...rest } = Astro.props

const entry = slug && (await getEntry('pages', slug))
---

<Root
  class:list="link"
  href={slug ? `/${slug}/` : href}
  {as}
  {...rest}
>
  <slot>
    <Fragment set:html={entry?.data?.title ?? text ?? html} />
  </slot>
</Root>

<style is:global lang="scss">
  @layer fulldev {
    .link {
      display: inline-flex;
      flex-wrap: wrap;
      align-items: center;
      gap: var(--space-2);
      cursor: pointer;
      border: none;
      background: none;
      color: var(--color-11);
      font-size: var(--text-3);
      text-decoration-color: var(--border); // FIXME, werkt niet
      text-decoration: none;
      white-space: nowrap;

      &:is(p > &) {
        text-decoration: underline;
      }

      &:hover {
        color: var(--color-12);
      }
    }
  }
</style>
