---
import { Font } from "astro:assets"
import { getEntry } from "astro:content"
import config from "fulldev:config"

import { Button } from "@/components/ui/button"
import { Icon } from "@/components/ui/icon"
import ModeToggleProvider from "@/components/ui/mode-toggle/mode-toggle-provider.astro"
import Block from "@/components/block.astro"
import Layout from "@/components/layout.astro"

export async function getStaticPaths() {
  const skeletons = import.meta.glob("src/components/skeletons/**/*.astro")
  return Object.entries(skeletons).map(([path, value]) => {
    const id = path.split("/").pop()?.split(".")[0]
    return {
      params: {
        skeleton: id,
      },
      props: {
        id,
        value,
      },
    }
  })
}

const { value } = Astro.props
const Comp = ((await value?.()) as any)?.default
const id = Astro.params.skeleton || "index"

const indexLayout = await getEntry("layouts", "index")

console.log({ layout: indexLayout?.data })
---

<Layout
  {...config}
  {...indexLayout?.data.seo}
  title={`${id} - Skeletons`}
  description={`${id} skeleton component`}
>
  <Fragment slot="head">
    <ModeToggleProvider />
    <Font cssVariable="--font-base" preload />
    <Font cssVariable="--font-heading" preload />
    <Fragment set:html={indexLayout?.data.head} />
  </Fragment>
  <Block block={indexLayout?.data.header} />
  <Block block={indexLayout?.data.banner} />
  <main class="@container flex flex-col">
    <Comp />
  </main>
  <Block block={indexLayout?.data.footer} />
  <Fragment set:html={indexLayout?.data.body} />
</Layout>
