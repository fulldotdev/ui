---
import { getCollection, getEntry, render } from "astro:content"

import { getHref } from "@/lib/get-href"
import Layout from "@/components/misc/layout.astro"
import Page from "@/components/misc/page.astro"

export async function getStaticPaths() {
  const pages = await getCollection("pages")
  return pages.map((page) => ({
    params: {
      page: getHref(page.id) === "/" ? undefined : getHref(page.id),
    },
    props: page,
  }))
}

const { Content } = await render(Astro.props)
const { seo, ...page } = Astro.props.data

const layout = await getEntry("layouts", "base")
---

<Layout {...layout?.data} {...seo}>
  <Page {...page}>
    <Content />
  </Page>
</Layout>
