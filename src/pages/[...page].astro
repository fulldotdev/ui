---
import settings from "@/data/settings.json"
import { getCollection, render } from "astro:content"

import { getHref } from "@/lib/get-href"
import { getSlug } from "@/lib/get-slug"
import Page from "@/components/misc/page.astro"

export async function getStaticPaths() {
  const pages = await getCollection("pages")
  return pages.map((page) => {
    return {
      params: {
        page: getSlug(page),
      },
      props: {
        page: page,
        search: pages.map((page) => ({
          text: page.data.title,
          href: getHref(page),
        })),
      },
    }
  })
}

const { page, search } = Astro.props
const { Content } = await render(page)
---

<Page search={search} {...page.data} {...settings}>
  <Content />
</Page>
