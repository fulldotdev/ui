---
import { getPages } from "@/adapters/shopify/api"
import { pageSchema } from "@/schemas/page"
import { getCollection } from "astro:content"
import type { CollectionEntry } from "astro:content"
import config from "fulldev.json"

import Page from "@/components/misc/page.astro"

export async function getStaticPaths() {
  const pages = await getCollection("pages")
  const transformedPages = pages.map(transformPage) // does references and add id, slug, href to data. at the end of this, also parse the schema again.

  return transformedPages.map((page) => ({
    params: {
      page: ["index", "home"].includes(page.slug) ? undefined : page.slug,
    },
    props: {
      page,
      search: pages.map((page) => ({
        text: page.title,
        href: page.href,
      })),
    },
  }))
}

const { page, search } = Astro.props
---

<Page search={search} {...page} />
